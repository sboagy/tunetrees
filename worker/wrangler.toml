name = "tunetrees-sync-worker"
main = "src/index.ts"
compatibility_date = "2024-04-01"
compatibility_flags = ["nodejs_compat"]

# Hyperdrive Binding (PostgreSQL Connection Pooling)
# Manages connection pooling to prevent "too many connections" errors
[[hyperdrive]]
binding = "HYPERDRIVE"
id = "541252cc94ca43cf83aa01ec4936726f"

[vars]
SUPABASE_URL = "https://pjxuonglsvouttihjven.supabase.co"
# SUPABASE_JWT_SECRET should be set via `wrangler secret put SUPABASE_JWT_SECRET`

# Optional: sync diagnostics (debug only)
# When enabled, the worker includes a `debug[]` array in sync responses.
# SYNC_DIAGNOSTICS = "true"
# Optional: restrict diagnostics to a single auth user id (JWT `sub`)
# SYNC_DIAGNOSTICS_USER_ID = "<supabase-auth-uid>"

[observability]
enabled = true
